{% extends "layout.html" %}
{% block title %}Upload Result - EDEMROBIN{% endblock %}

{% block content %}
<div class="mb-6 border-b border-slate-200 pb-4">
    <h1 class="text-2xl font-bold text-slate-700">Parsed Config: {{ filename }}</h1>
    <p class="text-slate-500">Review the parsed interfaces below before saving to the database.</p>
</div>

<div class="flex items-center gap-4 mb-6">
  <a href="/dashboard/upload_config/export?filename={{ filename }}"
     class="bg-slate-600 text-white font-semibold rounded-lg px-4 py-2 text-sm hover:bg-slate-500 transition">Export as CSV</a>

  <div class="border-l border-slate-300 h-8"></div>

  <form action="/dashboard/upload_config/save" method="post" onsubmit="return confirm('Are you sure you want to save these results to the database? This may create new IP Blocks and Subnets.');">
      <input type="hidden" name="filename" value="{{ filename }}">
      <button type="submit" class="bg-sky-600 text-white font-semibold rounded-lg px-4 py-2 text-sm hover:bg-sky-500 transition">
        Save Results to Database
      </button>
  </form>
</div>

<h2 class="text-xl font-semibold text-slate-600 mb-4">Found Interfaces with IP Addresses</h2>
<div class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-x-auto">
  <table class="min-w-full">
    <thead class="bg-slate-50">
      <tr>
        <th class="text-left p-4 text-sm font-semibold text-slate-600">Interface</th>
        <th class="text-left p-4 text-sm font-semibold text-slate-600">IP Address</th>
        <th class="text-left p-4 text-sm font-semibold text-slate-600">Subnet Mask</th>
        <th class="text-left p-4 text-sm font-semibold text-slate-600">Description</th>
        <th class="text-left p-4 text-sm font-semibold text-slate-600">VLAN ID</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-slate-200">
      {% for iface in interfaces %}
      <tr class="hover:bg-slate-50">
        <td class="p-4 font-mono text-sm">{{ iface.name }}</td>
        <td class="p-4 font-mono text-sm">{{ iface.ip_address }}</td>
        <td class="p-4 font-mono text-sm">{{ iface.subnet_mask }}</td>
        <td class="p-4 text-sm text-slate-600">{{ iface.description or '-' }}</td>
        <td class="p-4 text-sm text-center font-semibold {% if iface.vlan_id %}text-sky-700{% else %}text-slate-400{% endif %}">
          {{ iface.vlan_id or '-' }}
        </td>
      </tr>
      {% endfor %}
      {% if not interfaces %}
      <tr><td colspan="5" class="p-6 text-center text-slate-500">No interfaces with IP addresses were found in this config.</td></tr>
      {% endif %}
    </tbody>
  </table>
</div>
{% endblock %}
