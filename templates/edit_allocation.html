{% extends "layout.html" %}

{% block title %}Edit Allocation - {{ subnet.cidr }} - EDEMROBIN{% endblock %}

{% block content %}
<div class="mb-6 border-b border-slate-200 pb-4">
    <h1 class="text-2xl font-bold text-slate-700">Edit Allocation: <span class="font-mono">{{ subnet.cidr }}</span></h1>
    <p class="text-slate-500">Update the details for this subnet.</p>
</div>

{% if subnet.status.name == 'inactive' %}
<div class="bg-amber-50 border-l-4 border-amber-400 text-amber-800 p-4 rounded-md mb-6 shadow-sm" role="alert">
  <div class="flex">
    <div class="py-1"><svg class="fill-current h-6 w-6 text-amber-500 mr-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zM9 5v6h2V5H9zm0 8v2h2v-2H9z"/></svg></div>
    <div>
      <p class="font-bold">This subnet is inactive.</p>
      <p class="text-sm">It was imported without a matching parent block. Please assign it to a valid block to activate it.</p>
    </div>
  </div>
</div>
{% endif %}

<div class="bg-white rounded-lg shadow-sm border border-slate-200 p-6 max-w-2xl mx-auto">
  <form method="post" action="/dashboard/allocations/{{ subnet.id }}/edit" class="space-y-4">

    <div>
      <label for="description" class="text-sm font-medium text-slate-600 block mb-1">Description</label>
      <input type="text" name="description" id="description" value="{{ subnet.description or '' }}" class="w-full border-slate-300 rounded-md shadow-sm focus:border-sky-500 focus:ring-sky-500" required>
    </div>

    <div>
      <label for="vlan_id" class="text-sm font-medium text-slate-600 block mb-1">VLAN (optional)</label>
      <select name="vlan_id" id="vlan_id" class="w-full border-slate-300 rounded-md shadow-sm focus:border-sky-500 focus:ring-sky-500">
        <option value="">-- No VLAN --</option>
        {% for vlan in vlans %}
          <option value="{{ vlan.id }}" {% if subnet.vlan_id == vlan.id %}selected{% endif %}>
            {{ vlan.vlan_id }} - {{ vlan.name }}
          </option>
        {% endfor %}
      </select>
    </div>

    <div>
      <label for="block_id" class="text-sm font-medium text-slate-600 block mb-1">Parent Block</label>
      <select name="block_id" id="block_id" class="w-full border-slate-300 rounded-md shadow-sm focus:border-sky-500 focus:ring-sky-500" required>
        {% for block in blocks %}
          <option value="{{ block.id }}" {% if subnet.block_id == block.id %}selected{% endif %}>
            {{ block.cidr }} {% if block.description %}({{ block.description }}){% endif %}
          </option>
        {% endfor %}
      </select>
    </div>

    <div class="flex justify-end gap-3 pt-4">
        <a href="/" class="bg-slate-200 text-slate-800 font-semibold rounded-lg px-4 py-2 text-sm hover:bg-slate-300 transition">Cancel</a>
        <button type="submit" class="bg-slate-800 text-white font-semibold rounded-lg px-4 py-2 text-sm hover:bg-slate-700 transition">Save Changes</button>
    </div>
  </form>
</div>
{% endblock %}
